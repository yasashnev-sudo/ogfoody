{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergejasasnev/Downloads/my-project%20%281%29/app/api/debug/report/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { writeFile, mkdir } from 'fs/promises';\nimport { join } from 'path';\nimport { existsSync } from 'fs';\n\nexport const dynamic = 'force-dynamic';\n\ninterface DebugReport {\n  logs: string[];\n  screenshot?: string; // base64\n  meta?: {\n    userId?: string;\n    userEmail?: string;\n    url?: string;\n    userAgent?: string;\n    timestamp?: string;\n    errorMessage?: string;\n    [key: string]: any;\n  };\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body: DebugReport = await request.json();\n    const { logs, screenshot, meta } = body;\n\n    // –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç\n    const debugDir = join(process.cwd(), 'debug_reports');\n    if (!existsSync(debugDir)) {\n      await mkdir(debugDir, { recursive: true });\n    }\n\n    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Å timestamp –∏ userId\n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n    const userId = meta?.userId || 'guest';\n    const baseFileName = `${timestamp}_user-${userId}`;\n\n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–≥–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª\n    const logsFileName = `${baseFileName}_logs.txt`;\n    const logsFilePath = join(debugDir, logsFileName);\n    \n    const logsContent = [\n      '='.repeat(80),\n      'DEBUG REPORT',\n      '='.repeat(80),\n      `Timestamp: ${meta?.timestamp || new Date().toISOString()}`,\n      `User ID: ${userId}`,\n      `User Email: ${meta?.userEmail || 'N/A'}`,\n      `URL: ${meta?.url || 'N/A'}`,\n      `User Agent: ${meta?.userAgent || 'N/A'}`,\n      meta?.errorMessage ? `Error Message: ${meta.errorMessage}` : '',\n      meta?.userComment ? `\\nüìù USER COMMENT:\\n${meta.userComment}` : '', // ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n      '',\n      'Additional Metadata:',\n      JSON.stringify(meta, null, 2),\n      '',\n      '='.repeat(80),\n      'LOGS',\n      '='.repeat(80),\n      '',\n      ...logs,\n      '',\n      '='.repeat(80),\n      'END OF REPORT',\n      '='.repeat(80),\n    ].filter(Boolean).join('\\n');\n\n    await writeFile(logsFilePath, logsContent, 'utf-8');\n\n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å\n    let screenshotFileName = '';\n    if (screenshot) {\n      screenshotFileName = `${baseFileName}_screenshot.png`;\n      const screenshotFilePath = join(debugDir, screenshotFileName);\n      \n      // –£–±–∏—Ä–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å data:image/png;base64, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å\n      const base64Data = screenshot.replace(/^data:image\\/png;base64,/, '');\n      await writeFile(screenshotFilePath, base64Data, 'base64');\n    }\n\n    console.log(`[DEBUG REPORT] Saved report: ${logsFileName}${screenshot ? ` and ${screenshotFileName}` : ''}`);\n\n    return NextResponse.json({\n      success: true,\n      files: {\n        logs: logsFileName,\n        screenshot: screenshotFileName || null,\n      },\n      message: 'Debug report saved successfully',\n    });\n  } catch (error: any) {\n    console.error('[DEBUG REPORT ERROR]', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error.message || 'Failed to save debug report',\n      },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAgBhB,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAoB,MAAM,QAAQ,IAAI;QAC5C,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG;QAEnC,yCAAyC;QACzC,MAAM,WAAW,IAAA,yGAAI,EAAC,QAAQ,GAAG,IAAI;QACrC,IAAI,CAAC,IAAA,2GAAU,EAAC,WAAW;YACzB,MAAM,IAAA,8HAAK,EAAC,UAAU;gBAAE,WAAW;YAAK;QAC1C;QAEA,4CAA4C;QAC5C,MAAM,YAAY,IAAI,OAAO,WAAW,GAAG,OAAO,CAAC,SAAS;QAC5D,MAAM,SAAS,MAAM,UAAU;QAC/B,MAAM,eAAe,GAAG,UAAU,MAAM,EAAE,QAAQ;QAElD,kCAAkC;QAClC,MAAM,eAAe,GAAG,aAAa,SAAS,CAAC;QAC/C,MAAM,eAAe,IAAA,yGAAI,EAAC,UAAU;QAEpC,MAAM,cAAc;YAClB,IAAI,MAAM,CAAC;YACX;YACA,IAAI,MAAM,CAAC;YACX,CAAC,WAAW,EAAE,MAAM,aAAa,IAAI,OAAO,WAAW,IAAI;YAC3D,CAAC,SAAS,EAAE,QAAQ;YACpB,CAAC,YAAY,EAAE,MAAM,aAAa,OAAO;YACzC,CAAC,KAAK,EAAE,MAAM,OAAO,OAAO;YAC5B,CAAC,YAAY,EAAE,MAAM,aAAa,OAAO;YACzC,MAAM,eAAe,CAAC,eAAe,EAAE,KAAK,YAAY,EAAE,GAAG;YAC7D,MAAM,cAAc,CAAC,oBAAoB,EAAE,KAAK,WAAW,EAAE,GAAG;YAChE;YACA;YACA,KAAK,SAAS,CAAC,MAAM,MAAM;YAC3B;YACA,IAAI,MAAM,CAAC;YACX;YACA,IAAI,MAAM,CAAC;YACX;eACG;YACH;YACA,IAAI,MAAM,CAAC;YACX;YACA,IAAI,MAAM,CAAC;SACZ,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC;QAEvB,MAAM,IAAA,kIAAS,EAAC,cAAc,aAAa;QAE3C,mCAAmC;QACnC,IAAI,qBAAqB;QACzB,IAAI,YAAY;YACd,qBAAqB,GAAG,aAAa,eAAe,CAAC;YACrD,MAAM,qBAAqB,IAAA,yGAAI,EAAC,UAAU;YAE1C,sDAAsD;YACtD,MAAM,aAAa,WAAW,OAAO,CAAC,4BAA4B;YAClE,MAAM,IAAA,kIAAS,EAAC,oBAAoB,YAAY;QAClD;QAEA,QAAQ,GAAG,CAAC,CAAC,6BAA6B,EAAE,eAAe,aAAa,CAAC,KAAK,EAAE,oBAAoB,GAAG,IAAI;QAE3G,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;gBACL,MAAM;gBACN,YAAY,sBAAsB;YACpC;YACA,SAAS;QACX;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO,MAAM,OAAO,IAAI;QAC1B,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}