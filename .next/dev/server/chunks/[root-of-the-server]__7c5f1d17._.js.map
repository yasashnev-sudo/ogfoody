{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergejasasnev/Downloads/my-project%20%281%29/app/api/db/setup-relationships/route.ts"],"sourcesContent":["// API route –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ –≤ NocoDB\n\nimport { NextResponse } from \"next/server\"\n\ninterface Relationship {\n  fromTable: string\n  fromColumn: string\n  toTable: string\n  toColumn: string\n  type: \"hm\" | \"bt\" | \"mm\" // hasMany, belongsTo, manyToMany\n  title: string\n}\n\nconst relationships: Relationship[] = [\n  // Orders -> Users (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É) - —Å–æ–∑–¥–∞–µ–º belongsTo –≤ Orders\n  {\n    fromTable: \"Orders\",\n    fromColumn: \"user_id\",\n    toTable: \"Users\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å\",\n  },\n  // Order_Persons -> Orders (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)\n  {\n    fromTable: \"Order_Persons\",\n    fromColumn: \"order_id\",\n    toTable: \"Orders\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–ó–∞–∫–∞–∑\",\n  },\n  // Order_Meals -> Order_Persons (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)\n  {\n    fromTable: \"Order_Meals\",\n    fromColumn: \"order_person_id\",\n    toTable: \"Order_Persons\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–ü–µ—Ä—Å–æ–Ω–∞\",\n  },\n  // Order_Extras -> Orders (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)\n  {\n    fromTable: \"Order_Extras\",\n    fromColumn: \"order_id\",\n    toTable: \"Orders\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–ó–∞–∫–∞–∑\",\n  },\n  // Order_Meals -> Meals (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)\n  {\n    fromTable: \"Order_Meals\",\n    fromColumn: \"meal_id\",\n    toTable: \"Meals\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–ë–ª—é–¥–æ\",\n  },\n  // Order_Extras -> Extras (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)\n  {\n    fromTable: \"Order_Extras\",\n    fromColumn: \"extra_id\",\n    toTable: \"Extras\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ\",\n  },\n  // Reviews -> Orders (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)\n  {\n    fromTable: \"Reviews\",\n    fromColumn: \"order_id\",\n    toTable: \"Orders\",\n    toColumn: \"Id\",\n    type: \"bt\",\n    title: \"–ó–∞–∫–∞–∑\",\n  },\n]\n\nfunction getTableId(tableName: string): string {\n  const envKey = `NOCODB_TABLE_${tableName.toUpperCase()}`\n  const tableId = process.env[envKey]\n  if (!tableId) {\n    throw new Error(`Table ID not found for ${tableName}. Set ${envKey} environment variable.`)\n  }\n  return tableId\n}\n\nasync function createRelationship(\n  baseUrl: string,\n  token: string,\n  baseId: string,\n  relationship: Relationship,\n): Promise<{ success: boolean; error?: string; message?: string }> {\n  try {\n    const fromTableId = getTableId(relationship.fromTable)\n    const toTableId = getTableId(relationship.toTable)\n\n    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∞–±–ª–∏—Ü–µ –∏ –µ—ë –∫–æ–ª–æ–Ω–∫–∞—Ö\n    const tablesUrl = `${baseUrl}/api/v2/meta/bases/${baseId}/tables`\n    const tablesResponse = await fetch(tablesUrl, {\n      headers: {\n        \"xc-token\": token,\n        \"Content-Type\": \"application/json\",\n      },\n    })\n\n    if (!tablesResponse.ok) {\n      return {\n        success: false,\n        error: `Failed to fetch tables: ${tablesResponse.status}`,\n      }\n    }\n\n    const tablesData = await tablesResponse.json()\n    const table = tablesData?.list?.find((t: any) => t.id === fromTableId)\n\n    if (!table) {\n      return {\n        success: false,\n        error: `Table ${relationship.fromTable} not found`,\n      }\n    }\n\n    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤\n    let columns: any[] = []\n    let existingColumn: any = null\n    \n    // –°–ø–æ—Å–æ–± 1: –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã\n    if (table.columns && table.columns.length > 0) {\n      columns = table.columns\n    } else {\n      // –°–ø–æ—Å–æ–± 2: —á–µ—Ä–µ–∑ endpoint –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫\n      const columnsUrl1 = `${baseUrl}/api/v2/meta/bases/${baseId}/tables/${fromTableId}/columns`\n      const columnsResponse1 = await fetch(columnsUrl1, {\n        headers: {\n          \"xc-token\": token,\n          \"Content-Type\": \"application/json\",\n        },\n      })\n      \n      if (columnsResponse1.ok) {\n        const columnsData1 = await columnsResponse1.json()\n        columns = columnsData1?.list || []\n      } else {\n        // –°–ø–æ—Å–æ–± 3: —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π endpoint —Ç–∞–±–ª–∏—Ü—ã\n        const columnsUrl2 = `${baseUrl}/api/v2/meta/tables/${fromTableId}/columns`\n        const columnsResponse2 = await fetch(columnsUrl2, {\n          headers: {\n            \"xc-token\": token,\n            \"Content-Type\": \"application/json\",\n          },\n        })\n        \n        if (columnsResponse2.ok) {\n          const columnsData2 = await columnsResponse2.json()\n          columns = columnsData2?.list || []\n        } else {\n          // –°–ø–æ—Å–æ–± 4: –ø–æ–ª—É—á–∞–µ–º —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Å—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É\n          const recordsUrl = `${baseUrl}/api/v2/tables/${fromTableId}/records?limit=1`\n          const recordsResponse = await fetch(recordsUrl, {\n            headers: {\n              \"xc-token\": token,\n              \"Content-Type\": \"application/json\",\n            },\n          })\n          \n          if (recordsResponse.ok) {\n            const recordsData = await recordsResponse.json()\n            const sampleRecord = recordsData?.list?.[0]\n            if (sampleRecord) {\n              // –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–π –∑–∞–ø–∏—Å–∏\n              columns = Object.keys(sampleRecord).map((key) => ({\n                column_name: key,\n                title: key,\n                id: key, // –í—Ä–µ–º–µ–Ω–Ω—ã–π ID\n              }))\n            }\n          }\n        }\n      }\n    }\n    \n    // –ò—â–µ–º –∫–æ–ª–æ–Ω–∫—É –ø–æ —Ä–∞–∑–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º –Ω–∞–∑–≤–∞–Ω–∏–π\n    existingColumn = columns.find(\n      (col: any) => col.column_name === relationship.fromColumn || col.title === relationship.fromColumn,\n    )\n    \n    // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –ø–æ –¥—Ä—É–≥–∏–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º\n    if (!existingColumn) {\n      existingColumn = columns.find(\n        (col: any) => col.column_name?.replace(/_/g, \"\") === relationship.fromColumn.replace(/_/g, \"\"),\n      )\n    }\n    \n    // –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ –Ω–∞—à–ª–∏, –≤—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫\n    if (!existingColumn) {\n      const availableColumns = columns.map((col: any) => col.column_name || col.title).join(\", \")\n      return {\n        success: false,\n        error: `Column ${relationship.fromColumn} not found in table ${relationship.fromTable}. Available columns: ${availableColumns || \"none\"}`,\n      }\n    }\n    \n    // –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π ID –∫–æ–ª–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ\n    // –ü—Ä–æ–±—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–ª—É—á–µ–Ω–∏—è ID\n    let columnId = existingColumn.id\n    \n    if (!columnId || columnId === existingColumn.column_name || typeof columnId === 'string' && !columnId.match(/^[a-z0-9]+$/i)) {\n      // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å ID —á–µ—Ä–µ–∑ endpoint –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö\n      const metaUrl1 = `${baseUrl}/api/v2/meta/tables/${fromTableId}/columns`\n      const metaResponse1 = await fetch(metaUrl1, {\n        headers: {\n          \"xc-token\": token,\n          \"Content-Type\": \"application/json\",\n        },\n      })\n      \n      if (metaResponse1.ok) {\n        const metaData1 = await metaResponse1.json()\n        const metaColumn1 = metaData1?.list?.find(\n          (col: any) => col.column_name === relationship.fromColumn || col.title === relationship.fromColumn,\n        )\n        if (metaColumn1 && metaColumn1.id) {\n          columnId = metaColumn1.id\n          existingColumn = metaColumn1\n        }\n      }\n      \n      // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –ø—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ bases\n      if (!columnId || columnId === existingColumn.column_name) {\n        const metaUrl2 = `${baseUrl}/api/v2/meta/bases/${baseId}/tables/${fromTableId}/columns`\n        const metaResponse2 = await fetch(metaUrl2, {\n          headers: {\n            \"xc-token\": token,\n            \"Content-Type\": \"application/json\",\n          },\n        })\n        \n          if (metaResponse2.ok) {\n          const metaData2 = await metaResponse2.json()\n          const metaColumn2 = metaData2?.list?.find(\n            (col: any) => col.column_name === relationship.fromColumn || col.title === relationship.fromColumn,\n          )\n          if (metaColumn2) {\n            if (metaColumn2.id) {\n              columnId = metaColumn2.id\n            }\n            existingColumn = { ...existingColumn, ...metaColumn2 }\n          }\n        }\n      }\n    }\n    \n    if (!columnId || columnId === existingColumn.column_name) {\n      return {\n        success: false,\n        error: `Could not find column ID for ${relationship.fromColumn} in table ${relationship.fromTable}`,\n      }\n    }\n\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–≤—è–∑—å\n    if (existingColumn.uidt === \"LinkToAnotherRecord\") {\n      const existingLink = existingColumn.meta?.foreign_table\n      if (existingLink === toTableId) {\n        return {\n          success: true,\n          message: `Relationship already exists: ${relationship.fromTable}.${relationship.fromColumn} -> ${relationship.toTable}`,\n        }\n      }\n    }\n\n    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É –Ω–∞ LinkToAnotherRecord\n    // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ endpoints\n    let updateResponse: Response | null = null\n    \n    // –í–∞—Ä–∏–∞–Ω—Ç 1: —á–µ—Ä–µ–∑ bases\n    const updateColumnUrl1 = `${baseUrl}/api/v2/meta/bases/${baseId}/tables/${fromTableId}/columns/${columnId}`\n    updateResponse = await fetch(updateColumnUrl1, {\n      method: \"PATCH\",\n      headers: {\n        \"xc-token\": token,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        uidt: \"LinkToAnotherRecord\",\n        title: relationship.title,\n        meta: {\n          type: relationship.type,\n          foreign_key: relationship.toColumn,\n          foreign_table: toTableId,\n          foreign_table_column: relationship.toColumn,\n        },\n      }),\n    })\n    \n    // –ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –ø—Ä–æ–±—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç 2: –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ tables\n    if (!updateResponse.ok) {\n      const updateColumnUrl2 = `${baseUrl}/api/v2/meta/tables/${fromTableId}/columns/${columnId}`\n      updateResponse = await fetch(updateColumnUrl2, {\n        method: \"PATCH\",\n        headers: {\n          \"xc-token\": token,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          uidt: \"LinkToAnotherRecord\",\n          title: relationship.title,\n          meta: {\n            type: relationship.type,\n            foreign_key: relationship.toColumn,\n            foreign_table: toTableId,\n            foreign_table_column: relationship.toColumn,\n          },\n        }),\n      })\n    }\n\n    if (!updateResponse || !updateResponse.ok) {\n      const errorText = updateResponse ? await updateResponse.text() : \"No response\"\n      return {\n        success: false,\n        error: `Failed to update column: ${updateResponse?.status || \"unknown\"} - ${errorText}`,\n      }\n    }\n\n    return {\n      success: true,\n      message: `Relationship created: ${relationship.fromTable}.${relationship.fromColumn} -> ${relationship.toTable}.${relationship.toColumn}`,\n    }\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    }\n  }\n}\n\nexport async function POST() {\n  const NOCODB_URL = process.env.NOCODB_URL\n  const NOCODB_TOKEN = process.env.NOCODB_TOKEN\n  const NOCODB_BASE_ID = process.env.NOCODB_PROJECT_ID || process.env.NOCODB_BASE_ID\n\n  if (!NOCODB_URL || !NOCODB_TOKEN) {\n    return NextResponse.json(\n      {\n        error: \"NocoDB not configured\",\n        message: \"NOCODB_URL –∏ NOCODB_TOKEN –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã\",\n      },\n      { status: 500 },\n    )\n  }\n\n  if (!NOCODB_BASE_ID) {\n    return NextResponse.json(\n      {\n        error: \"NOCODB_BASE_ID not configured\",\n        message: \"NOCODB_PROJECT_ID –∏–ª–∏ NOCODB_BASE_ID –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã\",\n      },\n      { status: 500 },\n    )\n  }\n\n  const baseUrl = NOCODB_URL.replace(/\\/api\\/v2\\/?$/, \"\")\n  const results: Record<string, any> = {}\n\n  // –°–æ–∑–¥–∞–µ–º –∫–∞–∂–¥—É—é —Å–≤—è–∑—å\n  for (const relationship of relationships) {\n    const key = `${relationship.fromTable}.${relationship.fromColumn}->${relationship.toTable}`\n    console.log(`üîó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–≤—è–∑–∏: ${key}`)\n    const result = await createRelationship(baseUrl, NOCODB_TOKEN, NOCODB_BASE_ID, relationship)\n    results[key] = result\n    if (result.success) {\n      console.log(`‚úÖ ${result.message}`)\n    } else {\n      console.error(`‚ùå ${result.error}`)\n    }\n  }\n\n  const summary = {\n    total: relationships.length,\n    created: Object.values(results).filter((r) => r.success).length,\n    errors: Object.values(results).filter((r) => !r.success).length,\n    existing: Object.values(results).filter((r) => r.success && r.message?.includes(\"already exists\")).length,\n  }\n\n  return NextResponse.json({\n    success: summary.errors === 0,\n    summary,\n    results,\n    message: `–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ ${summary.created} —Å–≤—è–∑–µ–π –∏–∑ ${summary.total}`,\n  })\n}\n\n"],"names":[],"mappings":"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"}}]
}