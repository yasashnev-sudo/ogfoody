{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/sergejasasnev/Downloads/my-project%20%281%29/app/api/db/check-structure/route.ts"],"sourcesContent":["// API route для проверки структуры таблиц NocoDB\n// Сравнивает реальную структуру таблиц с ожидаемой в коде\n\nimport { NextResponse } from \"next/server\"\n\n// Ожидаемые структуры таблиц на основе интерфейсов в lib/nocodb.ts\nconst expectedSchemas: Record<string, Array<{ name: string; type: string; required?: boolean; description?: string }>> = {\n  Meals: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"name\", type: \"string\", required: true },\n    { name: \"category\", type: \"string\", required: true },\n    { name: \"ingredients\", type: \"string\", required: true },\n    { name: \"description\", type: \"string\", required: false },\n    { name: \"price\", type: \"number|string\", required: false, description: \"Legacy field\" },\n    { name: \"price_single\", type: \"number|string\", required: false },\n    { name: \"price_medium\", type: \"number|string\", required: false },\n    { name: \"price_large\", type: \"number|string\", required: false },\n    { name: \"weight\", type: \"number|string\", required: false, description: \"Legacy field\" },\n    { name: \"weight_single\", type: \"number|string\", required: false },\n    { name: \"weight_medium\", type: \"number|string\", required: false },\n    { name: \"weight_large\", type: \"number|string\", required: false },\n    { name: \"image\", type: \"string\", required: false },\n    { name: \"available\", type: \"boolean|string\", required: false },\n    { name: \"needs_garnish\", type: \"boolean|string\", required: false },\n    { name: \"calories\", type: \"number|string\", required: false },\n    { name: \"protein\", type: \"number|string\", required: false },\n    { name: \"fats\", type: \"number|string\", required: false },\n    { name: \"carbs\", type: \"number|string\", required: false },\n    { name: \"is_current_week\", type: \"boolean|string\", required: false },\n    { name: \"is_next_week\", type: \"boolean|string\", required: false },\n  ],\n  Extras: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"name\", type: \"string\", required: true },\n    { name: \"category\", type: \"string\", required: true },\n    { name: \"ingredients\", type: \"string\", required: false },\n    { name: \"description\", type: \"string\", required: false },\n    { name: \"price\", type: \"number|string\", required: true },\n    { name: \"image\", type: \"string\", required: false },\n    { name: \"available\", type: \"boolean|string\", required: false },\n    { name: \"calories\", type: \"number|string\", required: false },\n    { name: \"protein\", type: \"number|string\", required: false },\n    { name: \"fats\", type: \"number|string\", required: false },\n    { name: \"carbs\", type: \"number|string\", required: false },\n    { name: \"weight\", type: \"number|string\", required: false },\n  ],\n  Delivery_Zones: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"city\", type: \"string\", required: true },\n    { name: \"district\", type: \"string\", required: false },\n    { name: \"delivery_fee\", type: \"number|string\", required: true },\n    { name: \"min_order_amount\", type: \"number|string\", required: true },\n    { name: \"is_available\", type: \"boolean|string\", required: false },\n    { name: \"available_intervals\", type: \"string\", required: false, description: \"JSON array as string\" },\n  ],\n  Users: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"phone\", type: \"string\", required: true },\n    { name: \"password_hash\", type: \"string\", required: false },\n    { name: \"name\", type: \"string\", required: true },\n    { name: \"additional_phone\", type: \"string\", required: false },\n    { name: \"street\", type: \"string\", required: false },\n    { name: \"building\", type: \"string\", required: false },\n    { name: \"building_section\", type: \"string\", required: false },\n    { name: \"apartment\", type: \"string\", required: false },\n    { name: \"entrance\", type: \"string\", required: false },\n    { name: \"floor\", type: \"string\", required: false },\n    { name: \"intercom\", type: \"string\", required: false },\n    { name: \"district\", type: \"string\", required: false },\n    { name: \"delivery_comment\", type: \"string\", required: false },\n    { name: \"loyalty_points\", type: \"number|string\", required: true },\n    { name: \"total_spent\", type: \"number|string\", required: true },\n    { name: \"created_at\", type: \"string\", required: true },\n    { name: \"updated_at\", type: \"string\", required: true },\n  ],\n  Orders: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"user_id\", type: \"number\", required: false },\n    { name: \"order_number\", type: \"string\", required: true },\n    { name: \"start_date\", type: \"string\", required: true },\n    { name: \"delivery_time\", type: \"string\", required: true },\n    { name: \"status\", type: \"string\", required: true, description: \"pending|paid|delivered|cancelled\" },\n    { name: \"payment_method\", type: \"string\", required: true, description: \"card|sbp|cash\" },\n    { name: \"paid\", type: \"boolean|string\", required: false },\n    { name: \"paid_at\", type: \"string\", required: false },\n    { name: \"delivered\", type: \"boolean|string\", required: false },\n    { name: \"cancelled\", type: \"boolean|string\", required: false },\n    { name: \"promo_code\", type: \"string\", required: false },\n    { name: \"promo_discount\", type: \"number|string\", required: false },\n    { name: \"loyalty_points_used\", type: \"number|string\", required: true },\n    { name: \"loyalty_points_earned\", type: \"number|string\", required: true },\n    { name: \"subtotal\", type: \"number|string\", required: true },\n    { name: \"total\", type: \"number|string\", required: true },\n    { name: \"guest_phone\", type: \"string\", required: false },\n    { name: \"guest_address\", type: \"string\", required: false },\n    { name: \"created_at\", type: \"string\", required: true },\n    { name: \"updated_at\", type: \"string\", required: true },\n  ],\n  Order_Persons: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"order_id\", type: \"number\", required: true },\n    { name: \"person_number\", type: \"number\", required: true },\n  ],\n  Order_Meals: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"order_person_id\", type: \"number\", required: true },\n    { name: \"day\", type: \"string\", required: true, description: \"day1|day2\" },\n    { name: \"meal_time\", type: \"string\", required: true, description: \"breakfast|lunch|dinner\" },\n    { name: \"meal_type\", type: \"string\", required: true, description: \"dish|salad|soup|main\" },\n    { name: \"meal_id\", type: \"number\", required: true },\n    { name: \"portion_size\", type: \"string\", required: true, description: \"single|medium|large\" },\n    { name: \"price\", type: \"number|string\", required: true },\n    { name: \"garnish_id\", type: \"number\", required: false },\n    { name: \"garnish_portion_size\", type: \"string\", required: false, description: \"single|medium|large\" },\n    { name: \"garnish_price\", type: \"number|string\", required: false },\n  ],\n  Order_Extras: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"order_id\", type: \"number\", required: true },\n    { name: \"extra_id\", type: \"number\", required: true },\n    { name: \"quantity\", type: \"number|string\", required: true },\n    { name: \"price\", type: \"number|string\", required: true },\n  ],\n  Promo_Codes: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"code\", type: \"string\", required: true },\n    { name: \"discount_type\", type: \"string\", required: true, description: \"percentage|fixed\" },\n    { name: \"discount_value\", type: \"number|string\", required: true },\n    { name: \"min_order_amount\", type: \"number|string\", required: false },\n    { name: \"max_discount\", type: \"number|string\", required: false },\n    { name: \"valid_from\", type: \"string\", required: false },\n    { name: \"valid_until\", type: \"string\", required: false },\n    { name: \"usage_limit\", type: \"number|string\", required: false },\n    { name: \"times_used\", type: \"number|string\", required: true },\n    { name: \"active\", type: \"boolean|string\", required: false },\n  ],\n  Reviews: [\n    { name: \"Id\", type: \"number\", required: true, description: \"Primary key\" },\n    { name: \"order_id\", type: \"number\", required: true },\n    { name: \"user_id\", type: \"number\", required: true },\n    { name: \"rating\", type: \"number|string\", required: true },\n    { name: \"text\", type: \"string\", required: false },\n    { name: \"created_at\", type: \"string\", required: true },\n    { name: \"updated_at\", type: \"string\", required: true },\n  ],\n}\n\nfunction getTableId(tableName: string): string {\n  const tableIds: Record<string, string | undefined> = {\n    Meals: process.env.NOCODB_TABLE_MEALS,\n    Extras: process.env.NOCODB_TABLE_EXTRAS,\n    Delivery_Zones: process.env.NOCODB_TABLE_DELIVERY_ZONES,\n    Users: process.env.NOCODB_TABLE_USERS,\n    Orders: process.env.NOCODB_TABLE_ORDERS,\n    Order_Persons: process.env.NOCODB_TABLE_ORDER_PERSONS,\n    Order_Meals: process.env.NOCODB_TABLE_ORDER_MEALS,\n    Order_Extras: process.env.NOCODB_TABLE_ORDER_EXTRAS,\n    Promo_Codes: process.env.NOCODB_TABLE_PROMO_CODES,\n    Reviews: process.env.NOCODB_TABLE_REVIEWS,\n  }\n  return tableIds[tableName] || \"\"\n}\n\nfunction mapNocoDBTypeToExpected(nocoType: string): string {\n  const typeMap: Record<string, string> = {\n    Number: \"number\",\n    Decimal: \"number\",\n    Float: \"number\",\n    Int: \"number\",\n    BigInt: \"number\",\n    Text: \"string\",\n    String: \"string\",\n    Varchar: \"string\",\n    LongText: \"string\",\n    Boolean: \"boolean\",\n    Checkbox: \"boolean\",\n    Date: \"string\",\n    DateTime: \"string\",\n    Time: \"string\",\n    JSON: \"string\",\n    JSONB: \"string\",\n  }\n  return typeMap[nocoType] || nocoType.toLowerCase()\n}\n\ninterface ColumnInfo {\n  column_name: string\n  dt?: string\n  uidt?: string\n  required?: boolean\n  pk?: boolean\n}\n\nexport async function GET() {\n  const NOCODB_URL = process.env.NOCODB_URL\n  const NOCODB_TOKEN = process.env.NOCODB_TOKEN\n  const NOCODB_BASE_ID = process.env.NOCODB_PROJECT_ID || process.env.NOCODB_BASE_ID\n\n  if (!NOCODB_URL || !NOCODB_TOKEN) {\n    return NextResponse.json(\n      {\n        error: \"NocoDB not configured\",\n        message: \"NOCODB_URL и NOCODB_TOKEN должны быть установлены\",\n      },\n      { status: 500 },\n    )\n  }\n\n  if (!NOCODB_BASE_ID) {\n    return NextResponse.json(\n      {\n        error: \"NOCODB_BASE_ID not configured\",\n        message: \"NOCODB_PROJECT_ID или NOCODB_BASE_ID должны быть установлены\",\n      },\n      { status: 500 },\n    )\n  }\n\n  const baseUrl = NOCODB_URL.replace(/\\/api\\/v2\\/?$/, \"\")\n  const results: Record<string, any> = {}\n\n  // Проверяем каждую таблицу\n  for (const [tableName, expectedColumns] of Object.entries(expectedSchemas)) {\n    const tableId = getTableId(tableName)\n    \n    if (!tableId) {\n      results[tableName] = {\n        status: \"not_configured\",\n        error: `NOCODB_TABLE_${tableName.toUpperCase()} не установлен`,\n      }\n      continue\n    }\n\n    try {\n      // Получаем структуру таблицы из примера записи\n      let actualColumns: any[] = []\n      let sampleRecord: any = null\n      \n      try {\n        const recordsUrl = `${baseUrl}/api/v2/tables/${tableId}/records?limit=1`\n        const recordsResponse = await fetch(recordsUrl, {\n          headers: {\n            \"xc-token\": NOCODB_TOKEN,\n            \"Content-Type\": \"application/json\",\n          },\n        })\n        \n        if (recordsResponse.ok) {\n          const recordsData = await recordsResponse.json()\n          sampleRecord = recordsData?.list?.[0] || null\n          \n          if (sampleRecord) {\n            // Создаем список колонок на основе ключей записи\n            actualColumns = Object.keys(sampleRecord).map((key) => {\n              const value = sampleRecord[key]\n              let uidt = 'Text'\n              if (typeof value === 'number') {\n                uidt = Number.isInteger(value) ? 'Int' : 'Float'\n              } else if (typeof value === 'boolean') {\n                uidt = 'Boolean'\n              } else if (value instanceof Date || (typeof value === 'string' && /^\\d{4}-\\d{2}-\\d{2}/.test(value))) {\n                uidt = 'DateTime'\n              }\n              return {\n                column_name: key,\n                uidt,\n                required: false,\n              }\n            })\n          }\n        } else {\n          const errorText = await recordsResponse.text()\n          results[tableName] = {\n            status: \"error\",\n            error: `Не удалось получить данные таблицы: ${recordsResponse.status} - ${errorText}`,\n          }\n          continue\n        }\n      } catch (e) {\n        results[tableName] = {\n          status: \"error\",\n          error: `Ошибка при получении данных: ${e instanceof Error ? e.message : String(e)}`,\n        }\n        continue\n      }\n\n      if (actualColumns.length === 0) {\n        results[tableName] = {\n          status: \"warning\",\n          error: \"Таблица пуста или недоступна. Не удалось определить структуру.\",\n        }\n        continue\n      }\n\n      // Создаем карту реальных колонок\n      const actualColumnsMap = new Map<string, ColumnInfo>()\n      actualColumns.forEach((col: any) => {\n        const colName = col.column_name || col.title || col.name\n        if (colName) {\n          actualColumnsMap.set(colName.toLowerCase(), {\n            column_name: colName,\n            dt: col.dt,\n            uidt: col.uidt,\n            required: col.rqd || col.required || false,\n            pk: col.pk || col.primary || false,\n          })\n        }\n      })\n\n      // Сравниваем с ожидаемыми\n      const missingColumns: string[] = []\n      const extraColumns: string[] = []\n      const typeMismatches: Array<{ column: string; expected: string; actual: string }> = []\n      const requiredMismatches: Array<{ column: string; expected: boolean; actual: boolean }> = []\n\n      // Проверяем ожидаемые колонки\n      for (const expectedCol of expectedColumns) {\n        const colKey = expectedCol.name.toLowerCase()\n        const actualCol = actualColumnsMap.get(colKey)\n\n        if (!actualCol) {\n          if (expectedCol.required) {\n            missingColumns.push(expectedCol.name)\n          }\n        } else {\n          // Проверяем тип\n          const actualType = mapNocoDBTypeToExpected(actualCol.uidt || actualCol.dt || \"unknown\")\n          const expectedTypes = expectedCol.type.split(\"|\")\n          \n          if (!expectedTypes.some((t) => actualType.includes(t) || t.includes(actualType))) {\n            typeMismatches.push({\n              column: expectedCol.name,\n              expected: expectedCol.type,\n              actual: actualType,\n            })\n          }\n\n          // Проверяем required\n          if (expectedCol.required && !actualCol.required && !actualCol.pk) {\n            requiredMismatches.push({\n              column: expectedCol.name,\n              expected: true,\n              actual: false,\n            })\n          }\n\n          // Удаляем из карты, чтобы найти лишние колонки\n          actualColumnsMap.delete(colKey)\n        }\n      }\n\n      // Оставшиеся в карте - лишние колонки (но это не ошибка)\n      actualColumnsMap.forEach((col) => {\n        extraColumns.push(col.column_name)\n      })\n\n\n      const hasIssues = missingColumns.length > 0 || typeMismatches.length > 0 || requiredMismatches.length > 0\n\n      results[tableName] = {\n        status: hasIssues ? \"issues\" : \"ok\",\n        tableId,\n        columns: {\n          expected: expectedColumns.length,\n          actual: actualColumns.length,\n          missing: missingColumns,\n          extra: extraColumns,\n          typeMismatches,\n          requiredMismatches,\n        },\n        sampleRecord: sampleRecord ? Object.keys(sampleRecord).slice(0, 5) : null,\n        recommendations: hasIssues\n          ? [\n              ...(missingColumns.length > 0\n                ? [`Добавьте отсутствующие обязательные колонки: ${missingColumns.join(\", \")}`]\n                : []),\n              ...(typeMismatches.length > 0\n                ? [\n                    `Проверьте типы колонок: ${typeMismatches.map((m) => `${m.column} (ожидается ${m.expected}, фактически ${m.actual})`).join(\", \")}`,\n                  ]\n                : []),\n              ...(requiredMismatches.length > 0\n                ? [\n                    `Сделайте обязательными колонки: ${requiredMismatches.map((m) => m.column).join(\", \")}`,\n                  ]\n                : []),\n            ]\n          : [\"✅ Структура таблицы соответствует ожиданиям\"],\n      }\n    } catch (error) {\n      results[tableName] = {\n        status: \"error\",\n        error: error instanceof Error ? error.message : String(error),\n      }\n    }\n  }\n\n  // Подсчитываем общую статистику\n  const stats = {\n    total: Object.keys(expectedSchemas).length,\n    ok: Object.values(results).filter((r) => r.status === \"ok\").length,\n    issues: Object.values(results).filter((r) => r.status === \"issues\").length,\n    errors: Object.values(results).filter((r) => r.status === \"error\").length,\n    notConfigured: Object.values(results).filter((r) => r.status === \"not_configured\").length,\n  }\n\n  return NextResponse.json({\n    success: true,\n    timestamp: new Date().toISOString(),\n    summary: {\n      ...stats,\n      overallStatus: stats.errors > 0 || stats.notConfigured > 0 ? \"error\" : stats.issues > 0 ? \"issues\" : \"ok\",\n    },\n    tables: results,\n    note: \"Проверьте результаты для каждой таблицы. Статус 'ok' означает, что структура подходит для работы проекта.\",\n  })\n}\n\n"],"names":[],"mappings":"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"}}]
}