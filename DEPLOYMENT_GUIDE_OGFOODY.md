# üöÄ –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é ogfoody.ru

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
2. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–æ–º–µ–Ω–∞)
3. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞)
4. [–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π](#–ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π-–¥–µ–ø–ª–æ–π)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ-–¥–µ–ø–ª–æ—è)
6. [–†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å](#—Ä–∞–±–æ—á–∏–π-–ø—Ä–æ—Ü–µ—Å—Å)
7. [–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
8. [Troubleshooting](#troubleshooting)

---

## üéØ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –ß—Ç–æ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å:

- ‚úÖ –î–æ–º–µ–Ω: `ogfoody.ru` (–∫—É–ø–ª–µ–Ω–Ω—ã–π –Ω–∞ reg.ru)
- ‚úÖ –°–µ—Ä–≤–µ—Ä: `5.129.194.168` (TimewebCloud)
- ‚úÖ NocoDB: `https://noco.povarnakolesah.ru`
- ‚úÖ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `https://github.com/yasashnev-sudo/ogfoody`
- ‚úÖ SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É

### –§–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ —è —Å–æ–∑–¥–∞–ª:

- ‚úÖ `.github/workflows/deploy.yml` - –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions
- ‚úÖ `ecosystem.config.js` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PM2
- ‚úÖ `nginx-ogfoody.conf` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
- ‚úÖ `server-setup.sh` - —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ `deploy-manual.sh` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è
- ‚úÖ `.env.production.example` - —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞

### –®–∞–≥ 1: DNS –Ω–∞ reg.ru

1. –ó–∞–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç reg.ru
2. –ù–∞–π–¥–∏—Ç–µ –¥–æ–º–µ–Ω `ogfoody.ru`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DNS"
4. –î–æ–±–∞–≤—å—Ç–µ A-–∑–∞–ø–∏—Å–∏:

```
–¢–∏–ø: A
–ü–æ–¥–¥–æ–º–µ–Ω: @
IP: 5.129.194.168
TTL: 3600

–¢–∏–ø: A
–ü–æ–¥–¥–æ–º–µ–Ω: www
IP: 5.129.194.168
TTL: 3600
```

5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
6. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-30 –º–∏–Ω—É—Ç –ø–æ–∫–∞ DNS —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS:

```bash
# –° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
ping ogfoody.ru
# –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å 5.129.194.168

nslookup ogfoody.ru
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π IP
```

---

## üñ•Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–†–µ–∫–æ–º–µ–Ω–¥—É—é!)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@5.129.194.168

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
wget https://raw.githubusercontent.com/yasashnev-sudo/ogfoody/main/server-setup.sh

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
chmod +x server-setup.sh
bash server-setup.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç:
- Node.js 20.x
- PM2
- Nginx
- Certbot (–¥–ª—è SSL)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç firewall
- –°–æ–∑–¥–∞—Å—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

<details>
<summary>–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ —à–∞–≥–∏</summary>

#### 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@5.129.194.168
```

#### 2. –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É

```bash
apt update && apt upgrade -y
```

#### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js 20.x

```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs
node -v  # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å v20.x.x
```

#### 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PM2

```bash
npm install -g pm2
pm2 startup systemd -u root --hp /root
```

#### 5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx

```bash
apt install -y nginx
systemctl enable nginx
systemctl start nginx
```

#### 6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Certbot

```bash
apt install -y certbot python3-certbot-nginx
```

#### 7. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall

```bash
ufw --force enable
ufw allow 'Nginx Full'
ufw allow OpenSSH
ufw allow 22/tcp
```

#### 8. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
mkdir -p /var/www/ogfoody
mkdir -p /var/www/ogfoody/logs
mkdir -p /var/www/letsencrypt
chown -R www-data:www-data /var/www/letsencrypt
```

</details>

---

## üöÄ –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π

### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /var/www/ogfoody
git clone https://github.com/yasashnev-sudo/ogfoody.git .
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env.production
nano /var/www/ogfoody/.env.production
```

–í—Å—Ç–∞–≤—å—Ç–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è):

```env
NODE_ENV=production
PORT=3000

# NocoDB
NOCODB_URL=https://noco.povarnakolesah.ru
NOCODB_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–∏–∑_nocodb

# Table IDs
NOCODB_TABLE_MEALS=mmtctn4flssh2ua
NOCODB_TABLE_EXTRAS=mksy21hmttmo855
NOCODB_TABLE_DELIVERY_ZONES=mpoppulqhsz1der
NOCODB_TABLE_USERS=mvrp4r9o3z69c45
NOCODB_TABLE_ORDERS=meddiicl0gr0r8y
NOCODB_TABLE_ORDER_PERSONS=mvr08d33zm5i8oi
NOCODB_TABLE_ORDER_MEALS=mz9uw5by177ygug
NOCODB_TABLE_ORDER_EXTRAS=mksy21hmttmo855
NOCODB_TABLE_PROMO_CODES=mgov8ce836696fy
NOCODB_TABLE_REVIEWS=mv8c69ib9muz9ki
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: `Ctrl+O`, `Enter`, `Ctrl+X`

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ —Å–±–æ—Ä–∫–∞

```bash
cd /var/www/ogfoody
npm install
npm run build
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2

```bash
pm2 start ecosystem.config.js
pm2 save
pm2 status
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ `http://localhost:3000`!

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

#### 5.1 –í—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è SSL)

```bash
cat > /etc/nginx/sites-available/ogfoody-temp.conf << 'EOF'
server {
    listen 80;
    server_name ogfoody.ru www.ogfoody.ru;
    
    location /.well-known/acme-challenge/ {
        root /var/www/letsencrypt;
    }
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
    }
}
EOF

ln -s /etc/nginx/sites-available/ogfoody-temp.conf /etc/nginx/sites-enabled/
nginx -t
systemctl reload nginx
```

#### 5.2 –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
certbot certonly --webroot \
  -w /var/www/letsencrypt \
  -d ogfoody.ru \
  -d www.ogfoody.ru \
  --agree-tos \
  --no-eff-email \
  --email admin@ogfoody.ru
```

#### 5.3 –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx

```bash
# –£–¥–∞–ª–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
rm /etc/nginx/sites-enabled/ogfoody-temp.conf

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
# (–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ nginx-ogfoody.conf –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ scp)
cp nginx-ogfoody.conf /etc/nginx/sites-available/ogfoody.conf
ln -s /etc/nginx/sites-available/ogfoody.conf /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ï—Å–ª–∏ –≤—Å—ë –û–ö, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx
systemctl reload nginx
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 status

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs ogfoody --lines 50

# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# https://ogfoody.ru
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/yasashnev-sudo/ogfoody
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**
3. –ù–∞–∂–º–∏—Ç–µ **New repository secret**

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ secrets:

| Name | Value | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-------|----------|
| `SERVER_HOST` | `5.129.194.168` | IP —Å–µ—Ä–≤–µ—Ä–∞ |
| `SERVER_USER` | `root` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH |
| `SERVER_PASSWORD` | `pULRoAvF@P-@4Y` | –ü–∞—Ä–æ–ª—å SSH (–≤—Ä–µ–º–µ–Ω–Ω–æ) |
| `SERVER_PATH` | `/var/www/ogfoody` | –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É |

### –®–∞–≥ 2 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SSH –∫–ª—é—á–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É—é** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSH –∫–ª—é—á –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

#### –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ SSH –∫–ª—é—á
ssh-keygen -t ed25519 -C "github-actions-ogfoody"

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id -i ~/.ssh/id_ed25519.pub root@5.129.194.168

# –í—ã–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
cat ~/.ssh/id_ed25519
```

#### –ù–∞ GitHub:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
2. –î–æ–±–∞–≤—å—Ç–µ secret `SERVER_SSH_KEY` —Å —ç—Ç–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
3. –£–¥–∞–ª–∏—Ç–µ secret `SERVER_PASSWORD`

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

```bash
# –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
cd /Users/sergejasasnev/Downloads/my-project\ \(1\)

# –°–¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
echo "# Test auto-deploy" >> README.md

# –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –∑–∞–ø—É—à—å—Ç–µ
git add .
git commit -m "Test auto-deployment"
git push
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ GitHub:
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions**
- –£–≤–∏–¥–∏—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π workflow "Deploy to ogfoody.ru"
- –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (2-3 –º–∏–Ω—É—Ç—ã)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∞–π—Ç: https://ogfoody.ru

---

## üîÑ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å (–∫–∞–∫ –¥–µ–ª–∞—Ç—å –¥–æ—Ä–∞–±–æ—Ç–∫–∏)

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π workflow:

```
1. –í—ã: "–î–æ–±–∞–≤—å –∫–æ—Ä–∑–∏–Ω—É —Ç–æ–≤–∞—Ä–æ–≤"
   ‚Üì
2. –Ø (AI): –î–µ–ª–∞—é –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
   ‚Üì
3. –í—ã: git add . && git commit -m "–î–æ–±–∞–≤–∏–ª –∫–æ—Ä–∑–∏–Ω—É" && git push
   ‚Üì
4. GitHub Actions: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç
   ‚Üì
5. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ ogfoody.ru ‚ú®
```

### –ü—Ä–∏–º–µ—Ä —Å–µ—Å—Å–∏–∏:

```bash
# –í Cursor - –≥–æ–≤–æ—Ä–∏—Ç–µ –º–Ω–µ —á—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
# –Ø –¥–µ–ª–∞—é –∏–∑–º–µ–Ω–µ–Ω–∏—è...

# –ü–æ—Ç–æ–º –≤—ã:
git status                           # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç–µ —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ
git add .                            # –î–æ–±–∞–≤–ª—è–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"   # –ö–æ–º–º–∏—Ç–∏—Ç–µ
git push                             # –ü—É—à–∏—Ç–µ

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è!
```

### –ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π:

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç
chmod +x deploy-manual.sh
./deploy-manual.sh
```

---

## üìä –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã PM2:

```bash
# –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 status

# –õ–æ–≥–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
pm2 logs ogfoody

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
pm2 logs ogfoody --lines 100

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
pm2 logs ogfoody --err

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart ogfoody

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop ogfoody

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
pm2 info ogfoody

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 monit
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Nginx:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
systemctl reload nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
systemctl restart nginx

# –°—Ç–∞—Ç—É—Å
systemctl status nginx

# –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–∞
tail -f /var/log/nginx/ogfoody_access.log

# –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
tail -f /var/log/nginx/ogfoody_error.log
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ cron, –Ω–æ –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é:
certbot renew

# –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
certbot renew --dry-run
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# Health check
curl https://ogfoody.ru/api/health

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
curl https://ogfoody.ru/api/diagnose
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤:

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏
htop

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –ü—Ä–æ—Ü–µ—Å—Å—ã Node.js
ps aux | grep node

# –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
netstat -tulpn | grep :3000
```

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
# –ü–∏–Ω–≥—É–µ—Ç—Å—è –ª–∏ –¥–æ–º–µ–Ω?
ping ogfoody.ru

# –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ Nginx?
systemctl status nginx

# –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?
pm2 status

# –î–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —Å–∞–π—Ç –ª–æ–∫–∞–ª—å–Ω–æ?
curl http://localhost:3000
```

**–†–µ—à–µ–Ω–∏—è:**

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
systemctl restart nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart ogfoody

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs ogfoody --lines 50
tail -f /var/log/nginx/ogfoody_error.log
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: 502 Bad Gateway

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ –∏–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
pm2 status

# –ï—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ
cd /var/www/ogfoody
pm2 start ecosystem.config.js

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
pm2 logs ogfoody --err
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –¢–æ–≤–∞—Ä—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ NocoDB

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env.production
cat /var/www/ogfoody/.env.production

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å NocoDB
curl -I https://noco.povarnakolesah.ru

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
curl https://ogfoody.ru/api/diagnose

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs ogfoody | grep -i nocodb
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
certbot certificates

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
certbot renew

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx
systemctl reload nginx
```

### –ü—Ä–æ–±–ª–µ–º–∞ 5: GitHub Actions –¥–µ–ø–ª–æ–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://github.com/yasashnev-sudo/ogfoody/actions
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ workflow
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

- `Permission denied` ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –∫–ª—é—á –∏–ª–∏ –ø–∞—Ä–æ–ª—å –≤ secrets
- `Port 22: Connection refused` ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `npm run build failed` ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏ –≤ –ª–æ–≥–∞—Ö

### –ü—Ä–æ–±–ª–µ–º–∞ 6: –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –û—á–∏—Å—Ç–∏—Ç–µ –ª–æ–≥–∏ PM2
pm2 flush

# –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à npm
npm cache clean --force

# –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã
cd /var/www/backups
ls -t ogfoody_backup_*.tar.gz | tail -n +6 | xargs rm

# –û—á–∏—Å—Ç–∏—Ç–µ –ª–æ–≥–∏ Nginx (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)
find /var/log/nginx -name "*.log" -type f -mtime +7 -delete
```

### –ü—Ä–æ–±–ª–µ–º–∞ 7: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–∞–¥–∞–µ—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –û—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é
cd /var/www/ogfoody
git log --oneline -10  # –ù–∞–π–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–º–º–∏—Ç
git reset --hard COMMIT_HASH
npm run build
pm2 restart ogfoody

# –ò–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –±—ç–∫–∞–ø–∞
cd /var/www/backups
ls -lt  # –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø
tar -xzf ogfoody_backup_TIMESTAMP.tar.gz -C /var/www/ogfoody
cd /var/www/ogfoody
pm2 restart ogfoody
```

---

## üì± –ë—ã—Å—Ç—Ä—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥

### –î–µ–ø–ª–æ–π:

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
git push

# –†—É—á–Ω–æ–π
./deploy-manual.sh

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—Ä—É—á–Ω—É—é
cd /var/www/ogfoody && git pull && npm install && npm run build && pm2 restart ogfoody
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ–≥–æ
pm2 status && systemctl status nginx

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs ogfoody

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–π—Ç–∞
curl -I https://ogfoody.ru
```

### –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
# –ß–µ—Ä–µ–∑ Git
cd /var/www/ogfoody
git log --oneline -10
git reset --hard COMMIT_HASH
npm run build && pm2 restart ogfoody

# –ß–µ—Ä–µ–∑ –±—ç–∫–∞–ø
cd /var/www/backups
tar -xzf ogfoody_backup_TIMESTAMP.tar.gz -C /var/www/ogfoody
pm2 restart ogfoody
```

---

## üîê –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å root

```bash
passwd
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
adduser ogfoody
usermod -aG sudo ogfoody
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏

```bash
# –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
ssh-keygen -t ed25519
ssh-copy-id root@5.129.194.168

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ—Ç–∫–ª—é—á–∏—Ç–µ –ø–∞—Ä–æ–ª—å SSH
nano /etc/ssh/sshd_config
# –ò–∑–º–µ–Ω–∏—Ç–µ: PasswordAuthentication no
systemctl restart sshd
```

### 4. –û–±–Ω–æ–≤–∏—Ç–µ Secrets –≤ GitHub

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH –∫–ª—é—á–µ–π –æ–±–Ω–æ–≤–∏—Ç–µ `SERVER_SSH_KEY` –∏ —É–¥–∞–ª–∏—Ç–µ `SERVER_PASSWORD`.

### 5. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É

```bash
apt update && apt upgrade -y
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

- **–°–∞–π—Ç:** https://ogfoody.ru
- **Health check:** https://ogfoody.ru/api/health
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** https://ogfoody.ru/api/diagnose

### –õ–æ–≥–∏:

- **PM2:** `pm2 logs ogfoody`
- **Nginx access:** `/var/log/nginx/ogfoody_access.log`
- **Nginx errors:** `/var/log/nginx/ogfoody_error.log`

### GitHub Actions:

- **Workflows:** https://github.com/yasashnev-sudo/ogfoody/actions
- **Secrets:** https://github.com/yasashnev-sudo/ogfoody/settings/secrets/actions

---

## ‚úÖ Checklist –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] DNS A-–∑–∞–ø–∏—Å—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (`ogfoody.ru` ‚Üí `5.129.194.168`)
- [ ] Node.js 20.x —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] PM2 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ü—Ä–æ–µ–∫—Ç —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω –≤ `/var/www/ogfoody`
- [ ] –§–∞–π–ª `.env.production` —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- [ ] –ü—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω (`npm run build`)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ —á–µ—Ä–µ–∑ PM2
- [ ] Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω —á–µ—Ä–µ–∑ certbot
- [ ] –°–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ HTTPS
- [ ] GitHub Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ —É –≤–∞—Å –±—É–¥–µ—Ç:

- ‚úÖ –†–∞–±–æ—á–∏–π —Å–∞–π—Ç –Ω–∞ https://ogfoody.ru
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ `git push`
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (HTTPS)
- ‚úÖ –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ë—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –¥–µ–ø–ª–æ–µ–º

**–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ—Å—Ç:**

1. –ì–æ–≤–æ—Ä–∏—Ç–µ –º–Ω–µ —á—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
2. –Ø –¥–µ–ª–∞—é –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –í—ã –¥–µ–ª–∞–µ—Ç–µ `git push`
4. –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ ogfoody.ru!

–£–¥–∞—á–∏! üöÄ


