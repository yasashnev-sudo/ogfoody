# üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ò –†–ï–®–ï–ù–ò–ï: API 503 –û—à–∏–±–∫–∞

## –î–∞—Ç–∞: 2026-01-11 23:50
## –°—Ç–∞—Ç—É—Å: ‚úÖ –†–ï–®–ï–ù–ò–ï –ì–û–¢–û–í–û

---

## üìä –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –°–∏–º–ø—Ç–æ–º—ã
- API endpoints `/api/menu` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 503 –æ—à–∏–±–∫—É
- –¢–æ–≤–∞—Ä—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç
- –í –ª–æ–≥–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞: `Failed to load resource: the server responded with a status of 503`

### –ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞
–ò–∑ –ª–æ–≥–æ–≤ dev —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–µ—Ä–º–∏–Ω–∞–ª 5):
```
[MENU API] Request started
[MENU API] Environment check:
  - NOCODB_URL: ‚ùå NOT SET
  - NOCODB_TOKEN: ‚ùå NOT SET
  - NOCODB_TABLE_MEALS: ‚ùå NOT SET
  - NOCODB_TABLE_EXTRAS: ‚ùå NOT SET
  - NOCODB_TABLE_DELIVERY_ZONES: ‚ùå NOT SET
[MENU API] Request params: weekType=current
[MENU API] ‚ùå NocoDB not configured. Missing variables: NOCODB_URL, NOCODB_TOKEN, NOCODB_TABLE_MEALS
```

**–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê:** –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ NocoDB.

---

## üîç –í–ê–ñ–ù–û–ï –û–¢–ö–†–´–¢–ò–ï

Dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑ **worktree –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏**, –∞ –Ω–µ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:
- –û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: `/Users/sergejasasnev/Downloads/my-project (1)`
- **–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (worktree):** `/Users/sergejasasnev/.cursor/worktrees/my-project__1_/zsx`

–ü–æ—ç—Ç–æ–º—É —Ñ–∞–π–ª `.env.local` –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ worktree –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏!

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### –í worktree –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`/Users/sergejasasnev/.cursor/worktrees/my-project__1_/zsx/`)
1. ‚úÖ `.env.local.example` - —à–∞–±–ª–æ–Ω —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. ‚úÖ `setup-env.sh` - —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### –í –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`/Users/sergejasasnev/Downloads/my-project (1)/`)
1. ‚úÖ `–°–†–û–ß–ù–û_–ß–ò–¢–ê–ô.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º
2. ‚úÖ `FIX_API_503_ERROR.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
3. ‚úÖ `QUICK_FIX_503.txt` - –∫—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞
4. ‚úÖ `setup-env-worktree.sh` - —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ worktree
5. ‚úÖ `.env.local.example` - —à–∞–±–ª–æ–Ω (–¥—É–±–ª–∏–∫–∞—Ç –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)

---

## üöÄ –ö–ê–ö –ò–°–ü–†–ê–í–ò–¢–¨ (–î–õ–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø)

### –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (3 –∫–æ–º–∞–Ω–¥—ã)
```bash
cd /Users/sergejasasnev/.cursor/worktrees/my-project__1_/zsx
./setup-env.sh
# –í–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω NocoDB
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä (Ctrl+C ‚Üí npm run dev)
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (–∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞)
```bash
cd "/Users/sergejasasnev/Downloads/my-project (1)"
./setup-env-worktree.sh
# –í–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω NocoDB
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä (Ctrl+C ‚Üí npm run dev)
```

---

## üìã –ß–¢–û –ù–£–ñ–ù–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ

1. **–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω NocoDB:**
   - –û—Ç–∫—Ä—ã—Ç—å https://noco.povarnakolesah.ru
   - Settings ‚Üí API Tokens
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - –í—ã–ø–æ–ª–Ω–∏—Ç—å `./setup-env.sh` (–∏–∑ worktree) –∏–ª–∏ `./setup-env-worktree.sh` (–∏–∑ –∫–æ—Ä–Ω—è)
   - –í–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä:**
   - Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å `npm run dev`
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞: `npm run dev`

---

## üîç –ü–†–û–í–ï–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ª–æ–≥–∞—Ö dev —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
[MENU API] Environment check:
  - NOCODB_URL: https://noco.povarnak... ‚úÖ
  - NOCODB_TOKEN: ********** ‚úÖ
  - NOCODB_TABLE_MEALS: mmtctn4fls... ‚úÖ
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ http://localhost:3000 - —Ç–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
- ‚úÖ http://localhost:3000/api/menu - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (–Ω–µ 503)
- ‚úÖ http://localhost:3000/api/diagnose - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `configured: true`

---

## üìù –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–í—Å–µ ID —Ç–∞–±–ª–∏—Ü –≤–∑—è—Ç—ã –∏–∑ —Ñ–∞–π–ª–∞ `VERCEL_ENV_SETUP.txt`:
```env
NOCODB_URL=https://noco.povarnakolesah.ru
NOCODB_TOKEN=<—Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è>
NOCODB_TABLE_MEALS=mmtctn4flssh2ua
NOCODB_TABLE_EXTRAS=mksy21hmttmo855
NOCODB_TABLE_DELIVERY_ZONES=mpoppulqhsz1der
NOCODB_TABLE_USERS=mvrp4r9o3z69c45
NOCODB_TABLE_ORDERS=meddiicl0gr0r8y
NOCODB_TABLE_ORDER_PERSONS=mvr08d33zm5i8oi
NOCODB_TABLE_ORDER_MEALS=mz9uw5by177ygug
NOCODB_TABLE_ORDER_EXTRAS=mksy21hmttmo855
NOCODB_TABLE_PROMO_CODES=mgov8ce836696fy
NOCODB_TABLE_REVIEWS=mv8c69ib9muz9ki
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–ö–æ–¥ –≤ `app/api/menu/route.ts` (—Å—Ç—Ä–æ–∫–∏ 73-105):
```typescript
if (!isNocoDBConfigured()) {
  const missingVars: string[] = []
  if (!nocodbUrl) missingVars.push("NOCODB_URL")
  if (!nocodbToken) missingVars.push("NOCODB_TOKEN")
  if (!mealsTableId) missingVars.push("NOCODB_TABLE_MEALS")
  
  return NextResponse.json({
    meals: { /* empty */ },
    extras: { /* empty */ },
    // ...
    reason: `NocoDB not configured. Missing variables: ${missingVars.join(", ")}`,
  }, { status: 503 })
}
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **Worktree –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è** - –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç! `.env.local` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–º, –∞ –Ω–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: `.env.local` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore` –∏ –Ω–µ –ø–æ–ø–∞–¥—ë—Ç –≤ Git.
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**: Next.js —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ dev —Å–µ—Ä–≤–µ—Ä–∞.
4. **–¢–æ–∫–µ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–æ–±–µ–ª–æ–≤** –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –∫–æ–Ω—Ü–µ.

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:
- ‚úÖ API `/api/menu` –≤–µ—Ä–Ω—ë—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö (200 OK)
- ‚úÖ –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∑–∞—Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ó–∞–∫–∞–∑—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –¥–æ—Å—Ç–∞–≤–∫–∞ - –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üìû –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–ê –û–°–¢–ê–Å–¢–°–Ø

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª `.env.local` —Å–æ–∑–¥–∞–Ω –∏–º–µ–Ω–Ω–æ –≤ worktree –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞: `cat .env.local | grep NOCODB_TOKEN`
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–æ–∫–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –∞–∫—Ç–∏–≤–Ω—ã–π
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å NocoDB: https://noco.povarnakolesah.ru
5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/api/diagnose` endpoint –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## ‚ú® –ò–¢–û–ì

**–í—Ä–µ–º—è –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ:** ~2 –º–∏–Ω—É—Ç—ã  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (–Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω NocoDB)  
**–°—Ç–∞—Ç—É—Å:** –†–µ—à–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ:
1. –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω NocoDB
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `./setup-env.sh`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä

–í—Å—ë! üéâ

