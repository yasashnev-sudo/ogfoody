# üîß –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–∏–¥–∂–µ—Ç–æ–º YooKassa: invalid_combination_of_payment_methods

**–î–∞—Ç–∞:** 2026-01-18  
**–°—Ç–∞—Ç—É—Å:** –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –≤–∏–¥–∂–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ redirect

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –õ–æ–≥–∏ –æ—Ç YooKassa (–¥–æ –¥–µ–ø–ª–æ—è)

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "amount": {
    "value": "3082.00",
    "currency": "RUB"
  },
  "confirmation": {
    "type": "embedded",
    "return_url": "https://ogfoody.ru/payment/success?orderId=1085"
  },
  "description": "–ó–∞–∫–∞–∑ #1085",
  "metadata": {
    "orderId": "1085"
  },
  "capture": true
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "30ff63cb-000f-5000-b000-19234d291e31",
  "status": "pending",
  "confirmation": {
    "type": "embedded",
    "confirmation_token": "ct-30ff63cb-000f-5000-b000-19234d291e31"
  },
  "test": true,
  "paid": false
}
```

**–í—ã–≤–æ–¥:** –ü–ª–∞—Ç–µ–∂ —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω. –ü—Ä–æ–±–ª–µ–º–∞ –≤ –≤–∏–¥–∂–µ—Ç–µ.

---

## üîç –ü—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–∫–∏ `invalid_combination_of_payment_methods`

–ü–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ YooKassa:

1. **–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã:**
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ç–æ–ª—å–∫–æ `bank_card` –∏ `mir_pay`, –µ—Å–ª–∏ —É –º–∞–≥–∞–∑–∏–Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å `payment_methods`
   - –î—Ä—É–≥–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É

2. **`customization_of_payment_methods_not_allowed`:**
   - –ö–æ–≥–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä `payment_methods` –≤–æ–æ–±—â–µ –Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ YooKassa

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤:**
   - YooKassa –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞
   - –≠—Ç–∏ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≤–∏–¥–∂–µ—Ç–∞

---

## ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–í–∏–¥–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ redirect:**

```typescript
// components/payment-modal.tsx
const shouldUseRedirect = true // –í—Ä–µ–º–µ–Ω–Ω–æ: redirect –≤–µ–∑–¥–µ
```

**–ü–æ—á–µ–º—É:**
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –æ–ø–ª–∞—Ç–∞ –≤–æ–æ–±—â–µ
- –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –≤–∏–¥–∂–µ—Ç–µ
- –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–ª—é—á–∞—Ö –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö YooKassa

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ YooKassa

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://yookassa.ru/my
2. –í—ã–±–µ—Ä–∏—Ç–µ –º–∞–≥–∞–∑–∏–Ω (Shop ID: 1251656)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –†–∞–∑—Ä–µ—à–µ–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å `payment_methods` –≤ –≤–∏–¥–∂–µ—Ç–µ
   - –ö–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
   - –ï—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–æ–≤

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh root@ogfoody.ru "cd /var/www/ogfoody && grep YOOKASSA .env"
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- `YOOKASSA_SHOP_ID=1251656`
- `YOOKASSA_SECRET_KEY=test_...` (–¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞)
- `YOOKASSA_TEST_MODE=true`

### 3. –õ–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞

```bash
ssh root@ogfoody.ru "cd /var/www/ogfoody && pm2 logs ogfoody --lines 100 | grep 'Creating YooKassa payment'"
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ redirect —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–±–ª–µ–º–∞ –≤ –≤–∏–¥–∂–µ—Ç–µ
2. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ YooKassa
3. –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π YooKassa

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ redirect –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–±–ª–µ–º–∞ –≤ –∫–ª—é—á–∞—Ö –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö YooKassa
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ redirect (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ)

1. –ï—Å–ª–∏ –≤–∏–¥–∂–µ—Ç –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ redirect
2. –≠—Ç–æ –ø—Ä–æ—â–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É YooKassa –¥–ª—è –æ–ø–ª–∞—Ç—ã

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è YooKassa: –í–∏–¥–∂–µ—Ç](https://yookassa.ru/developers/payment-acceptance/integration-scenarios/widget/quick-start)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è YooKassa: –û—à–∏–±–∫–∏ –≤–∏–¥–∂–µ—Ç–∞](https://yookassa.ru/developers/payment-acceptance/integration-scenarios/widget/reference)
- [–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç YooKassa](https://yookassa.ru/my)

---

**–°—Ç–∞—Ç—É—Å:** üîÑ –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ (redirect –≤–µ–∑–¥–µ)
