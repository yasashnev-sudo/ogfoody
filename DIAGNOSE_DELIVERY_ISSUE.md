# üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ü–û–ß–ï–ú–£ –ù–ï –°–û–•–†–ê–ù–Ø–ï–¢–°–Ø –°–¢–û–ò–ú–û–°–¢–¨ –î–û–°–¢–ê–í–ö–ò

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–æ–ª–±—Ü—ã `Delivery District` –∏ `Delivery Address` –ø—É—Å—Ç—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ Orders

---

## üéØ –ì–î–ï –ü–†–û–ë–õ–ï–ú–ê

–í—ã –ø—Ä–∞–≤—ã - –ø—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏! –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ **–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞.

---

## üîç –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–µ—Ä–º–∏–Ω–∞–ª —Å `npm run dev`)

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏:

```
üì• POST /api/orders - –ø–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
‚úÖ –ó–∞–∫–∞–∑ –ø–æ–ª—É—á–µ–Ω: { userId: 5, ... }
üöö –î–æ—Å—Ç–∞–≤–∫–∞: 250‚ÇΩ (—Ä–∞–π–æ–Ω: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω, —Å—É–º–º–∞: 1045‚ÇΩ)
‚úÖ Updated order XXX with total: 1295‚ÇΩ (subtotal: 1045‚ÇΩ, delivery: 250‚ÇΩ)
```

**–ï—Å–ª–∏ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤–∏–¥–∏—Ç–µ:**
```
‚ö†Ô∏è –†–∞–π–æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º 0
```

–ó–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–µ `District` –≤ —Ç–∞–±–ª–∏—Ü–µ `Users`.

---

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É Users –≤ NocoDB

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://noco.povarnakolesah.ru
2. –ù–∞–π–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `Users`
3. –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º `79219176619`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–µ `District`** (–∏–ª–∏ –∫–∞–∫ –æ–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è)

**–ï—Å–ª–∏ –ø–æ–ª–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `–†–∞–π–æ–Ω` –Ω–∞ —Ä—É—Å—Å–∫–æ–º):
- –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –≤ `app/api/orders/route.ts`

**–ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ:**
- –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ: `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω`
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑

---

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `Users` –∏ –Ω–∞–π–¥–∏—Ç–µ –ø–æ–ª—è –¥–ª—è –∞–¥—Ä–µ—Å–∞. –û–Ω–∏ –¥–æ–ª–∂–Ω—ã –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è:
- `District` (—Ä–∞–π–æ–Ω)
- `Street` (—É–ª–∏—Ü–∞)
- `Building` (–¥–æ–º)
- `Apartment` (–∫–≤–∞—Ä—Ç–∏—Ä–∞)

–ï—Å–ª–∏ –æ–Ω–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É - –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥.

---

## üîß –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ NocoDB

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `Users`
2. –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `79219176619`
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã:
   - `District` = `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω`
   - `Street` = `–ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç`
   - `Building` = `1`
   - `Apartment` = `10`
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `Orders` - –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å—Å—è

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:

```javascript
// check-user-fields.js
const NOCODB_URL = "https://noco.povarnakolesah.ru"
const NOCODB_TOKEN = "–≤–∞—à_—Ç–æ–∫–µ–Ω"
const NOCODB_TABLE_USERS = "mg9dm2m41bjv8ar"

async function checkUserFields() {
  const response = await fetch(
    `${NOCODB_URL}/api/v2/tables/${NOCODB_TABLE_USERS}/records?limit=1`,
    { headers: { "xc-token": NOCODB_TOKEN } }
  )
  
  const data = await response.json()
  if (data.list?.[0]) {
    console.log("–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:")
    console.log(Object.keys(data.list[0]))
  }
}

checkUserFields()
```

---

## üêõ –ö–û–î –ì–î–ï –ü–†–û–ò–°–•–û–î–ò–¢ –ü–†–û–ë–õ–ï–ú–ê

**–§–∞–π–ª:** `app/api/orders/route.ts`, —Å—Ç—Ä–æ–∫–∏ 373-392

```typescript
if (userId) {
  const user = await fetchUserById(userId)
  if (user) {
    deliveryDistrict = user.District || user.district || ""  // ‚Üê –ó–î–ï–°–¨!
    
    // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å
    const street = user.Street || user.street || ""
    const building = user.Building || user.building || ""
    const apartment = user.Apartment || user.apartment || ""
    deliveryAddress = `${street}, –¥. ${building}${apartment ? ', –∫–≤. ' + apartment : ''}`
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏
    if (calculatedTotal < 2300) {
      deliveryFee = await calculateDeliveryFee(deliveryDistrict, calculatedTotal)
      console.log(`üöö –î–æ—Å—Ç–∞–≤–∫–∞: ${deliveryFee}‚ÇΩ (—Ä–∞–π–æ–Ω: ${deliveryDistrict}, —Å—É–º–º–∞: ${calculatedTotal}‚ÇΩ)`)
    }
  }
}
```

**–ï—Å–ª–∏ `user.District` –ø—É—Å—Ç–æ–µ** ‚Üí `deliveryDistrict = ""`  
**–ï—Å–ª–∏ `deliveryDistrict` –ø—É—Å—Ç–æ–µ** ‚Üí —Ñ—É–Ω–∫—Ü–∏—è `calculateDeliveryFee` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—è –Ω–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –ë–î!

---

## ‚úÖ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ NocoDB

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ NocoDB
2. –¢–∞–±–ª–∏—Ü–∞ Users ‚Üí –Ω–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–µ District
```

### –®–∞–≥ 2: –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ

```
–ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
District: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
Street: –ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç
Building: 1
Apartment: 10
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –Ω–∞ —Å—É–º–º—É 1000-2299‚ÇΩ
3. –û–ø–ª–∞—Ç–∏—Ç–µ
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É Orders –≤ NocoDB
2. –ù–∞–π–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∑–∞–∫–∞–∑
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–æ–ª–±—Ü—ã:
   - Delivery Fee: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 250
   - Delivery District: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω"
   - Delivery Address: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ UI

```
1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–∫–∞–∑
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –±–ª–æ–∫ - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
   üöö –î–æ—Å—Ç–∞–≤–∫–∞: +250‚ÇΩ
```

---

## üîç –õ–û–ì–ò –î–õ–Ø –û–¢–õ–ê–î–ö–ò

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–æ–≥–∏:
```
üì• POST /api/orders - –ø–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å
‚úÖ –ó–∞–∫–∞–∑ –ø–æ–ª—É—á–µ–Ω: { userId: 5, ... }
üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å userId=5
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω: { District: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω", ... }
üöö –î–æ—Å—Ç–∞–≤–∫–∞: 250‚ÇΩ (—Ä–∞–π–æ–Ω: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω, —Å—É–º–º–∞: 1045‚ÇΩ)
üí∞ –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞: 1045‚ÇΩ + 250‚ÇΩ (–¥–æ—Å—Ç–∞–≤–∫–∞) = 1295‚ÇΩ
‚úÖ Updated order 123 with total: 1295‚ÇΩ (subtotal: 1045‚ÇΩ, delivery: 250‚ÇΩ)
```

### ‚ùå –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ª–æ–≥–∏:
```
‚ö†Ô∏è –†–∞–π–æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º 0
```
‚Üí –ó–Ω–∞—á–∏—Ç `user.District` –ø—É—Å—Ç–æ–µ

```
‚ö†Ô∏è –ó–æ–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è —Ä–∞–π–æ–Ω–∞ "XXX" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
```
‚Üí –†–∞–π–æ–Ω –µ—Å—Ç—å, –Ω–æ –µ–≥–æ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `Delivery_Zones`

---

## üí° –í–ê–ñ–ù–û

–ü—Ä–æ–±–ª–µ–º–∞ **–ù–ï** –≤ –∫–æ–¥–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è UI!  
–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ **–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ –ë–î –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞.

–ü—Ä–∏—á–∏–Ω—ã:
1. ‚ùå –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–µ `District` –≤ —Ç–∞–±–ª–∏—Ü–µ `Users`
2. ‚ùå –ü–æ–ª–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É
3. ‚ùå userId –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, —Ç.–∫. –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–µ `District` —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ NocoDB –∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑.

---

## üìû –ü–†–û–í–ï–†–û–ß–ù–´–ô –°–ü–ò–°–û–ö

- [ ] –û—Ç–∫—Ä—ã—Ç NocoDB
- [ ] –¢–∞–±–ª–∏—Ü–∞ Users –Ω–∞–π–¥–µ–Ω–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `79219176619` –Ω–∞–π–¥–µ–Ω
- [ ] –ü–æ–ª–µ `District` –∑–∞–ø–æ–ª–Ω–µ–Ω–æ: `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω`
- [ ] –ü–æ–ª—è –∞–¥—Ä–µ—Å–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑
- [ ] –í —Ç–∞–±–ª–∏—Ü–µ Orders –ø–æ—è–≤–∏–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ –æ –¥–æ—Å—Ç–∞–≤–∫–µ
- [ ] –í UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏

---

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —ç—Ç–æ –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!**



