# ‚úÖ –î–µ–ø–ª–æ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤–∏–¥–∂–µ—Ç–∞ YooKassa

## üìã –°—Ç–∞—Ç—É—Å:

‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –¥–µ–ø–ª–æ—é**

## üîß –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **API (`app/api/payments/yookassa/create/route.ts`)**:
   - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ `confirmation` (embedded/external)
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `useWidget` –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

2. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç (`components/payment-modal.tsx`)**:
   - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `order.paymentId` –≤–º–µ—Å—Ç–æ `order.payment_id`
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (–í–ö/–¢–ì) —á–µ—Ä–µ–∑ `detectPlatform()`
   - ‚úÖ –í–∏–¥–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ, –∫—Ä–æ–º–µ –í–ö –∏ –¢–ì (—Ç–∞–º redirect/—É–º–Ω—ã–π –ø–ª–∞—Ç–µ–∂)
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ redirect –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤–∏–¥–∂–µ—Ç–∞
   - ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞ –≤–∏–¥–∂–µ—Ç–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º

## üöÄ –î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω:

–°–∫—Ä–∏–ø—Ç `EXECUTE_DEPLOY.sh` –∑–∞–ø—É—â–µ–Ω –≤ —Ñ–æ–Ω–µ. –î–µ–ø–ª–æ–π –¥–æ–ª–∂–µ–Ω –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
expect check-deploy-status.expect

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
ssh root@5.129.194.168
cd /var/www/ogfoody
git log --oneline -1
pm2 status ogfoody
pm2 logs ogfoody --lines 20 | grep -i payment
```

## ‚úÖ –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://ogfoody.ru
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∏ –æ–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç
3. –í–∏–¥–∂–µ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ (–∫—Ä–æ–º–µ –í–ö/–¢–ì)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## üìù –ï—Å–ª–∏ –¥–µ–ø–ª–æ–π –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:

```bash
cd "/Users/sergejasasnev/Downloads/my-project (1)"
bash EXECUTE_DEPLOY.sh
```

–ò–ª–∏ –ø–æ —à–∞–≥–∞–º:

```bash
# 1. Git –æ–ø–µ—Ä–∞—Ü–∏–∏
git add components/payment-modal.tsx app/api/payments/yookassa/create/route.ts
git commit -m "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ YooKassa –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º"
git push origin main

# 2. –î–µ–ø–ª–æ–π
expect deploy-to-production.expect
```
