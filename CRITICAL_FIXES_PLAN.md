# üî¥ –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

---

## üìã –°–¢–ê–¢–£–° –ü–†–û–ë–õ–ï–ú

### ‚úÖ –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (–Ω–µ —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):

1. **‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ 1: –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞**
   - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û
   - **–§–∞–π–ª—ã:** 
     - `app/api/orders/route.ts` (—Å—Ç—Ä–æ–∫–∏ 789-802)
     - `app/api/orders/[id]/route.ts` (—Å—Ç—Ä–æ–∫–∏ 1263-1275, 386-389)
   - **–î–µ–π—Å—Ç–≤–∏–µ:** –ù–∏—á–µ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

2. **‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ 4: –û—Ç–∫–∞—Ç total_spent –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –∑–∞–∫–∞–∑–∞**
   - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û
   - **–§–∞–π–ª:** `lib/nocodb.ts` —Ñ—É–Ω–∫—Ü–∏—è `refundLoyaltyPoints` (—Å—Ç—Ä–æ–∫–∏ 1334-1364)
   - **–î–µ–π—Å—Ç–≤–∏–µ:** –ù–∏—á–µ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

---

## ‚ùå –¢–†–ï–ë–£–Æ–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:

### üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –í–´–°–û–ö–ê–Ø  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 1

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –ü–æ–ª–µ `usage_type` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `usage_type` **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–ê** –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ `once_per_user` –∏–ª–∏ `once_total` –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `components/order-modal.tsx` —Ñ—É–Ω–∫—Ü–∏—è `handleApplyPromo()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ:
  - ‚úÖ –î–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—è (`valid_from`, `valid_until`)
  - ‚úÖ –û–±—â–∏–π –ª–∏–º–∏—Ç (`usage_limit`)
  - ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É (`min_order_amount`)
  - ‚ùå **–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** `usage_type`

**–ì–¥–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- `components/order-modal.tsx` ‚Äî –≤ —Ñ—É–Ω–∫—Ü–∏—é `handleApplyPromo()` (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 810)

**–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

#### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `once_per_user`
```typescript
// –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ usage_limit (—Å—Ç—Ä–æ–∫–∞ 810)
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: once_per_user
const usageType = promo["Usage Type"] || promo.usage_type || "unlimited"
if (usageType === "once_per_user" && isAuthenticated && userProfile?.id) {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  const userOrders = await fetchOrders(userProfile.id)
  const hasUsedPromo = userOrders.some(
    (order) => (order.promo_code || order["Promo Code"]) === code
  )
  
  if (hasUsedPromo) {
    setAppliedPromo(null)
    showWarning(
      "–ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω",
      "–≠—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.",
      "error"
    )
    return
  }
}
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `once_total`
```typescript
// –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ once_per_user
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: once_total
if (usageType === "once_total") {
  const timesUsed = promo["Times Used"] || promo.times_used || 0
  if (timesUsed >= 1) {
    setAppliedPromo(null)
    showWarning(
      "–ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω",
      "–≠—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.",
      "error"
    )
    return
  }
}
```

#### –®–∞–≥ 3: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```typescript
// –í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ components/order-modal.tsx
import { fetchOrders } from "@/lib/nocodb"
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `components/order-modal.tsx` (—Å—Ç—Ä–æ–∫–∏ ~810-822)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å `usage_type = "once_per_user"`
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –≤ –∑–∞–∫–∞–∑–µ ‚Üí –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è
3. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø—Ä–æ–º–æ–∫–æ–¥ –≤–æ –≤—Ç–æ—Ä–æ–º –∑–∞–∫–∞–∑–µ ‚Üí –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞
4. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å `usage_type = "once_total"`
5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è
6. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞

---

### üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–π min_order_amount –∏ max_discount –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –°–†–ï–î–ù–Ø–Ø  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 2

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –ü–æ–ª—è `min_order_amount` –∏ `max_discount` —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Å—Ö–µ–º–µ –ë–î
- –ü–æ–ª—è **–ù–ï –û–¢–û–ë–†–ê–ñ–ê–Æ–¢–°–Ø** –≤ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä **–ù–ï –ú–û–ñ–ï–¢** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É –∑–∞–∫–∞–∑–∞ –∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–∏–¥–∫—É —á–µ—Ä–µ–∑ UI
- –ü–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏, –Ω–æ –∏—Ö –Ω–µ–ª—å–∑—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `app/admin/promo/page.tsx` —Ñ–æ—Ä–º–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - ‚úÖ `code` (–∫–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞)
  - ‚úÖ `discount_type` (—Ç–∏–ø —Å–∫–∏–¥–∫–∏)
  - ‚úÖ `discount_value` (–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∫–∏–¥–∫–∏)
  - ‚úÖ `valid_from` (–¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞)
  - ‚úÖ `valid_until` (–¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è)
  - ‚úÖ `usage_type` (—Ç–∏–ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
  - ‚úÖ `comment` (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)
  - ‚ùå **–û–¢–°–£–¢–°–¢–í–£–Æ–¢:** `min_order_amount`, `max_discount`

**–ì–¥–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- `app/admin/promo/page.tsx` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ —Ñ–æ—Ä–º—É (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 495)

**–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

#### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ state —Ñ–æ—Ä–º—ã
```typescript
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ AdminPromoPage, –≤ state formData
const [formData, setFormData] = useState({
  code: "",
  discount_type: "percentage" as "percentage" | "fixed",
  discount_value: 0,
  usage_type: "unlimited" as "unlimited" | "once_per_user" | "once_total",
  valid_from: "",
  valid_until: "",
  active: true,
  comment: "",
  min_order_amount: 0,  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨
  max_discount: 0,     // ‚úÖ –î–û–ë–ê–í–ò–¢–¨
})
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ —Ñ–æ—Ä–º—É (–ø–æ—Å–ª–µ discount_value, —Å—Ç—Ä–æ–∫–∞ ~495)
```typescript
<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
  {/* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è discount_value */}
  
  {/* ‚úÖ –î–û–ë–ê–í–ò–¢–¨: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ */}
  <div className="space-y-2">
    <Label htmlFor="min_order_amount" className="text-black font-bold">
      –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ (‚ÇΩ)
    </Label>
    <Input
      id="min_order_amount"
      type="text"
      inputMode="decimal"
      value={formData.min_order_amount || ""}
      onChange={(e) => {
        const input = e.target.value.replace(/[^0-9.,]/g, "").replace(",", ".")
        const value = input === "" ? 0 : parseFloat(input) || 0
        setFormData({ ...formData, min_order_amount: value })
      }}
      className="border-2 border-black rounded-lg shadow-brutal"
      placeholder="1000"
    />
    <p className="text-sm text-gray-600">
      –ü—Ä–æ–º–æ–∫–æ–¥ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∫ –∑–∞–∫–∞–∑–∞–º –Ω–∞ —Å—É–º–º—É –æ—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–π
    </p>
  </div>

  {/* ‚úÖ –î–û–ë–ê–í–ò–¢–¨: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö) */}
  {formData.discount_type === "percentage" && (
    <div className="space-y-2">
      <Label htmlFor="max_discount" className="text-black font-bold">
        –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞ (‚ÇΩ)
      </Label>
      <Input
        id="max_discount"
        type="text"
        inputMode="decimal"
        value={formData.max_discount || ""}
        onChange={(e) => {
          const input = e.target.value.replace(/[^0-9.,]/g, "").replace(",", ".")
          const value = input === "" ? 0 : parseFloat(input) || 0
          setFormData({ ...formData, max_discount: value })
        }}
        className="border-2 border-black rounded-lg shadow-brutal"
        placeholder="500"
      />
      <p className="text-sm text-gray-600">
        –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ —Å–∫–∏–¥–∫–∏ –¥–ª—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
      </p>
    </div>
  )}
</div>
```

#### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å handleSubmit –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª–µ–π
```typescript
// –í —Ñ—É–Ω–∫—Ü–∏–∏ handleSubmit, –≤ –æ–±—ä–µ–∫—Ç–µ promoData
const promoData = {
  Code: formData.code,
  "Discount Type": formData.discount_type,
  "Discount Value": formData.discount_value,
  "Usage Type": formData.usage_type,
  "Valid From": formData.valid_from || null,
  "Valid Until": formData.valid_until || null,
  Active: formData.active,
  Comment: formData.comment || null,
  "Min Order Amount": formData.min_order_amount > 0 ? formData.min_order_amount : null,  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨
  "Max Discount": formData.max_discount > 0 ? formData.max_discount : null,            // ‚úÖ –î–û–ë–ê–í–ò–¢–¨
}
```

#### –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å handleEdit –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª–µ–π
```typescript
// –í —Ñ—É–Ω–∫—Ü–∏–∏ handleEdit, –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã
setFormData({
  code: promo.Code || "",
  discount_type: (promo["Discount Type"] || promo.discount_type || "percentage") as "percentage" | "fixed",
  discount_value: Number(promo["Discount Value"] || promo.discount_value || 0),
  usage_type: (promo["Usage Type"] || promo.usage_type || "unlimited") as "unlimited" | "once_per_user" | "once_total",
  valid_from: promo["Valid From"] || promo.valid_from || "",
  valid_until: promo["Valid Until"] || promo.valid_until || "",
  active: promo.Active !== false,
  comment: promo.Comment || promo.comment || "",
  min_order_amount: Number(promo["Min Order Amount"] || promo.min_order_amount || 0),  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨
  max_discount: Number(promo["Max Discount"] || promo.max_discount || 0),              // ‚úÖ –î–û–ë–ê–í–ò–¢–¨
})
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `app/admin/promo/page.tsx` (—Å—Ç—Ä–æ–∫–∏ ~33-573)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Üí –ü—Ä–æ–º–æ–∫–æ–¥—ã
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–º–æ–∫–æ–¥
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–µ–π "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞" –∏ "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—è –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
5. –û—Ç–∫—Ä—ã—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
7. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –≤ –∑–∞–∫–∞–∑–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

---

## üìä –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û): –ü—Ä–æ–±–ª–µ–º–∞ 2
- **–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
- **–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** ~2 —á–∞—Å–∞
- **–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û): –ü—Ä–æ–±–ª–µ–º–∞ 3
- **–ü—Ä–∏—á–∏–Ω–∞:** –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- **–í–ª–∏—è–Ω–∏–µ:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –Ω–µ –º–æ–≥—É—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- **–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** ~1.5 —á–∞—Å–∞
- **–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –≤ —Ñ–æ—Ä–º—É)

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ usage_type
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç `fetchOrders` –≤ `components/order-modal.tsx`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `once_per_user` –≤ `handleApplyPromo()`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `once_total` –≤ `handleApplyPromo()`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π `once_per_user`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π `once_total`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–º–æ–∫–æ–¥—ã `unlimited` —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ü–æ–ª—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å `min_order_amount` –∏ `max_discount` –≤ state —Ñ–æ—Ä–º—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ UI —Ñ–æ—Ä–º—ã (–ø–æ—Å–ª–µ `discount_value`)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `handleSubmit` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª–µ–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `handleEdit` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª–µ–π
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏

---

## üß™ –ü–õ–ê–ù –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ usage_type = "once_per_user"
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å `usage_type = "once_per_user"`
2. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –≤ –∑–∞–∫–∞–∑–µ ‚Üí ‚úÖ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è
4. –°–æ–∑–¥–∞—Ç—å –≤—Ç–æ—Ä–æ–π –∑–∞–∫–∞–∑
5. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí ‚ùå –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ "–ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω"
6. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B
7. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí ‚úÖ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è (–¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ usage_type = "once_total"
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å `usage_type = "once_total"`, `times_used = 0`
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí ‚úÖ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `times_used = 1` –≤ –ë–î
4. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å–Ω–æ–≤–∞ ‚Üí ‚ùå –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ "–ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω"

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ min_order_amount
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å `min_order_amount = 2000`
2. –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ —Å—É–º–º—É 1500‚ÇΩ
3. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí ‚ùå –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞"
4. –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–∞ –¥–æ —Å—É–º–º—ã 2500‚ÇΩ
5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí ‚úÖ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è

### –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ max_discount
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Å `discount_type = "percentage"`, `discount_value = 50`, `max_discount = 500`
2. –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ —Å—É–º–º—É 2000‚ÇΩ
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∫–∏–¥–∫–∞ = 500‚ÇΩ (50% –æ—Ç 2000 = 1000, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ 500)
5. –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ —Å—É–º–º—É 800‚ÇΩ
6. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∫–∏–¥–∫–∞ = 400‚ÇΩ (50% –æ—Ç 800 = 400, –º–µ–Ω—å—à–µ –ª–∏–º–∏—Ç–∞)

---

## üìù –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø

1. **–ü—Ä–æ–±–ª–µ–º–∞ 1 –∏ 4 —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã** ‚Äî —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω
2. **–ü—Ä–æ–±–ª–µ–º–∞ 2 –∫—Ä–∏—Ç–∏—á–Ω–∞** ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
3. **–ü—Ä–æ–±–ª–µ–º–∞ 3 –≤–∞–∂–Ω–∞** ‚Äî –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
4. –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç `LOYALTY_POINTS_AND_PROMO_SCENARIOS_ANALYSIS.md`

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–ª–∞–Ω –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Å –ü—Ä–æ–±–ª–µ–º—ã 2 (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)
