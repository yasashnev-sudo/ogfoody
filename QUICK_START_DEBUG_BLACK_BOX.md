# üêû –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ª–∞–¥–∫–∏ "–ß–µ—Ä–Ω—ã–π —è—â–∏–∫"

## –ß—Ç–æ —ç—Ç–æ?

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞ –æ—à–∏–±–æ–∫ —Å –ª–æ–≥–∞–º–∏ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤.

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!)

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ `handleAutoCheckout` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è**:
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–π–æ–Ω–∞
- ‚ùå –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ persons  
- ‚ùå –û—à–∏–±–∫–∏ API –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
- ‚ùå –õ—é–±—ã–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

–ü—Ä–∏ –æ—à–∏–±–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –î–µ–ª–∞–µ—Ç—Å—è —Å–∫—Ä–∏–Ω—à–æ—Ç —ç–∫—Ä–∞–Ω–∞ üì∏
2. –°–æ–±–∏—Ä–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –ª–æ–≥–æ–≤ üìù
3. –í—Å—ë –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `debug_reports/`

### 2. –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º

#### –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:
1. –ù–∞–π–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üêû** –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–µ—ë ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∫–æ–Ω—Å–æ–ª—å —Å –ª–æ–≥–∞–º–∏
3. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ (–º–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å: All / Error / Warn / Info)
4. –ù–∞–∂–º–∏—Ç–µ **"Send Debug Report"** –¥–ª—è —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

#### –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–æ–≤:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –æ—Ç—á–µ—Ç—ã
ls -la debug_reports/

# –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–æ–≥
cat $(ls -t debug_reports/*_logs.txt | head -1)

# –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∫—Ä–∏–Ω—à–æ—Ç
open $(ls -t debug_reports/*_screenshot.png | head -1)
```

## –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ handleAutoCheckout?

‚úÖ **–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞** - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–∫–∞–∑–∞  
‚úÖ **–†–∞—Å—á–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏** - —Ä–∞–π–æ–Ω –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å  
‚úÖ **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ payload** - –ü–û–õ–ù–´–ô JSON –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ API  
‚úÖ **–û—Ç–≤–µ—Ç API** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞  
‚úÖ **–í—Å–µ –æ—à–∏–±–∫–∏** - —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏ –¥–∞–Ω–Ω—ã–º–∏  

## –ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞

```
================================================================================
DEBUG REPORT
================================================================================
Timestamp: 2026-01-11T15:30:00.000Z
User ID: guest (–∏–ª–∏ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
User Email: user@example.com
URL: https://yourapp.com/
Error Message: CRITICAL: persons –ø—É—Å—Ç –ø—Ä–∏ –∞–≤—Ç–æ–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏

Logs:
[15:29:58] [LOG] üöÄ START handleAutoCheckout
[15:29:59] [LOG] üì§ POST /api/orders PAYLOAD: {...}
[15:30:00] [ERROR] CAPTURE ERROR: persons –ø—É—Å—Ç
================================================================================
```

+ –°–∫—Ä–∏–Ω—à–æ—Ç —ç–∫—Ä–∞–Ω–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—à–∏–±–∫–∏ (PNG)

## –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –±–∞–≥–∞ "–≥–æ—Å—Ç—è"

### –®–∞–≥–∏:
1. üßë –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ (–≥–æ—Å—Ç—å)
2. üçΩÔ∏è –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–∫–∞–∑ (–≤—ã–±–µ—Ä–∏—Ç–µ –±–ª—é–¥–∞, –¥–∞—Ç—É)
3. üí≥ –ù–∞–∂–º–∏—Ç–µ "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑"
4. üîê –ü—Ä–æ–π–¥–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
5. üìç –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å
6. ‚ö†Ô∏è –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞ ‚Üí –æ—Ç—á–µ—Ç —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤ –æ—Ç—á–µ—Ç–µ:
- [ ] –°–æ—Ö—Ä–∞–Ω–∏–ª—Å—è –ª–∏ `pendingCheckout` –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏?
- [ ] –ï—Å—Ç—å –ª–∏ `persons` –≤ –º–∞—Å—Å–∏–≤–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π?
- [ ] –ö–∞–∫–æ–π `paymentMethod` –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω? (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç–æ–π!)
- [ ] –ß—Ç–æ –≤–µ—Ä–Ω—É–ª —Å–µ—Ä–≤–µ—Ä –≤ `errorData`?
- [ ] –ß—Ç–æ –≤–∏–¥–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ?

## –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã

```
app/
  api/
    debug/
      report/
        route.ts              ‚Üê API endpoint

hooks/
  useDebugRecorder.tsx        ‚Üê –û—Å–Ω–æ–≤–Ω–æ–π —Ö—É–∫

components/
  debug/
    DebugFloatingButton.tsx   ‚Üê –ö–Ω–æ–ø–∫–∞ üêû
    DebugConsole.tsx          ‚Üê UI –∫–æ–Ω—Å–æ–ª–∏

app/
  page.tsx                    ‚Üê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ handleAutoCheckout

debug_reports/                ‚Üê –ó–¥–µ—Å—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –æ—Ç—á–µ—Ç—ã
  (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è git)
```

## –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, –¥–æ–±–∞–≤—å—Ç–µ —É—Å–ª–æ–≤–∏–µ:

```typescript
// –í app/page.tsx
{process.env.NODE_ENV === 'development' && (
  <DebugFloatingButton userId={userId} userEmail={userEmail} />
)}
```

–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞—â–∏—Ç—É –≤ API:

```typescript
// –í app/api/debug/report/route.ts
if (process.env.NODE_ENV === 'production') {
  return NextResponse.json({ error: 'Not available in production' }, { status: 403 })
}
```

## ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –û—Ç—á–µ—Ç—ã –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å **—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (email, –∑–∞–∫–∞–∑—ã)
- –ü–∞–ø–∫–∞ `debug_reports/` —É–∂–µ –≤ `.gitignore`
- **–ù–ï** –∫–æ–º–º–∏—Ç—å—Ç–µ –æ—Ç—á–µ—Ç—ã –≤ Git
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ **–æ—á–∏—â–∞–π—Ç–µ** —Å—Ç–∞—Ä—ã–µ –æ—Ç—á–µ—Ç—ã:
  ```bash
  rm -rf debug_reports/*
  ```

## –ì–æ—Ç–æ–≤–æ! üéâ

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –±–∞–≥ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –æ—Ç—á–µ—Ç!

---

üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `DEBUG_BLACK_BOX_SYSTEM.md`


